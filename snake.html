<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Snake Game Smooth</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #fafafa;
    margin: 0;
    padding: 20px;
  }
  h1 { margin: 10px 0; }
  #score { font-size: 18px; margin: 10px 0; }
  canvas { background: #fff; border: 2px solid #333; display:block; margin:auto; touch-action: none; }
  button {
    margin: 10px;
    padding: 8px 16px;
    background: #333; color: #fff;
    border: none; border-radius: 5px;
    cursor: pointer;
  }
  .ad {
    margin: 15px auto;
    padding: 10px;
    border: 2px dashed #aaa;
    background: #eee;
    width: 90%; max-width: 728px;
  }
</style>
</head>
<body>
  <h1>Snake and Apple üçé</h1>

  <div class="ad">[Top Banner Ad]</div>

  <div id="score">Score: 0</div>
  <canvas id="game"></canvas><br>
  <button onclick="startGame()">Restart Game</button>

  <div class="ad">[Bottom Banner Ad]</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const gridSize = 20;
let snake, apple, dir, score, speed, lastMoveTime;

function resizeCanvas() {
  const size = Math.min(window.innerWidth - 40, 400);
  canvas.width = size;
  canvas.height = size;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function startGame() {
  snake = [{x:200, y:200}];
  dir = {x: gridSize, y: 0};
  score = 0;
  speed = 220; // slightly faster
  lastMoveTime = 0;
  placeApple();
  requestAnimationFrame(gameLoop);
}

function placeApple() {
  const maxCells = Math.floor(canvas.width / gridSize);
  apple = {
    x: Math.floor(Math.random() * maxCells) * gridSize,
    y: Math.floor(Math.random() * maxCells) * gridSize
  };
}

function gameLoop(timestamp) {
  if (!lastMoveTime) lastMoveTime = timestamp;
  if (timestamp - lastMoveTime > speed) {
    moveSnake();
    lastMoveTime = timestamp;
  }
  draw();
  requestAnimationFrame(gameLoop);
}

function moveSnake() {
  const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

  if (head.x < 0 || head.y < 0 || head.x >= canvas.width || head.y >= canvas.height ||
      snake.some(s => s.x === head.x && s.y === head.y)) {
    alert("Game Over! Score: " + score);
    startGame();
    return;
  }

  snake.unshift(head);

  if (head.x === apple.x && head.y === apple.y) {
    score++;
    placeApple();
    if (speed > 60) speed -= 2; // gentle acceleration
  } else {
    snake.pop();
  }
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw snake
  snake.forEach((s,i)=>{
    if(i===0){
      ctx.fillStyle="darkgreen";
      ctx.fillRect(s.x,s.y,gridSize,gridSize);

      // Eyes
      ctx.fillStyle="white";
      ctx.beginPath();
      ctx.arc(s.x+5,s.y+5,3,0,Math.PI*2);
      ctx.arc(s.x+15,s.y+5,3,0,Math.PI*2);
      ctx.fill();

      ctx.fillStyle="black";
      ctx.beginPath();
      ctx.arc(s.x+5,s.y+5,1.5,0,Math.PI*2);
      ctx.arc(s.x+15,s.y+5,1.5,0,Math.PI*2);
      ctx.fill();
    } else {
      ctx.fillStyle="green";
      ctx.fillRect(s.x,s.y,gridSize,gridSize);
    }
  });

  // Draw apple
  ctx.fillStyle="red";
  ctx.fillRect(apple.x,apple.y,gridSize,gridSize);

  document.getElementById("score").textContent = "Score: "+score;
}

// Keyboard controls
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowUp" && dir.y===0) dir={x:0,y:-gridSize};
  if(e.key==="ArrowDown" && dir.y===0) dir={x:0,y:gridSize};
  if(e.key==="ArrowLeft" && dir.x===0) dir={x:-gridSize,y:0};
  if(e.key==="ArrowRight" && dir.x===0) dir={x:gridSize,y:0};
});

// Touch controls
let startX,startY;
document.addEventListener("touchstart", e=>{
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
});
document.addEventListener("touchend", e=>{
  const dx=e.changedTouches[0].clientX-startX;
  const dy=e.changedTouches[0].clientY-startY;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>30 && dir.x===0) dir={x:gridSize,y:0};
    else if(dx<-30 && dir.x===0) dir={x:-gridSize,y:0};
  } else {
    if(dy>30 && dir.y===0) dir={x:0,y:gridSize};
    else if(dy<-30 && dir.y===0) dir={x:0,y:-gridSize};
  }
});

startGame();
</script>
</body>
</html>
