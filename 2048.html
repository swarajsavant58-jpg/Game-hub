<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>2048 Game</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #faf8ef;
    display: flex;
    justify-content: center;
    margin: 0;
    padding: 20px;
  }
  .container { width: 100%; max-width: 400px; }
  header { display: flex; justify-content: space-between; align-items: center; }
  h1 { margin: 0; color: #776e65; }
  .score { background: #bbada0; color: #fff; padding: 10px; border-radius: 5px; }
  button { padding: 8px 12px; border: none; border-radius: 5px; background: #8f7a66; color: #fff; cursor: pointer; }
  .ad { background: #eee; border: 2px dashed #ccc; text-align: center; padding: 15px; margin: 15px 0; }
  .board {
    background: #bbada0;
    padding: 10px;
    border-radius: 10px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
  }
  .cell {
    width: 80px; height: 80px;
    background: #cdc1b4;
    border-radius: 5px;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; font-weight: bold;
  }
  .n2 { background: #eee4da; color: #776e65; }
  .n4 { background: #ede0c8; color: #776e65; }
  .n8 { background: #f2b179; color: #f9f6f2; }
  .n16 { background: #f59563; color: #f9f6f2; }
  .n32 { background: #f67c5f; color: #f9f6f2; }
  .n64 { background: #f65e3b; color: #f9f6f2; }
  .n128 { background: #edcf72; color: #f9f6f2; font-size:20px; }
  .n256 { background: #edcc61; color: #f9f6f2; font-size:20px; }
  .n512 { background: #edc850; color: #f9f6f2; font-size:20px; }
  .n1024 { background: #edc53f; color: #f9f6f2; font-size:18px; }
  .n2048 { background: #edc22e; color: #f9f6f2; font-size:18px; }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>2048</h1>
    <div class="score">Score: <span id="score">0</span></div>
    <button onclick="startGame()">Restart</button>
  </header>

  <div class="ad">[Top Ad Slot]</div>

  <div class="board" id="board"></div>

  <div class="ad">[Bottom Ad Slot]</div>
</div>

<script>
const SIZE = 4;
let board = [];
let score = 0;

function startGame() {
  board = Array.from({ length: SIZE }, () => Array(SIZE).fill(0));
  score = 0;
  addRandomTile();
  addRandomTile();
  updateBoard();
}

function addRandomTile() {
  let empty = [];
  for (let r = 0; r < SIZE; r++) {
    for (let c = 0; c < SIZE; c++) {
      if (board[r][c] === 0) empty.push([r, c]);
    }
  }
  if (empty.length) {
    let [r, c] = empty[Math.floor(Math.random() * empty.length)];
    board[r][c] = Math.random() < 0.9 ? 2 : 4;
  }
}

function updateBoard() {
  const boardDiv = document.getElementById("board");
  boardDiv.innerHTML = "";
  for (let r = 0; r < SIZE; r++) {
    for (let c = 0; c < SIZE; c++) {
      const cell = document.createElement("div");
      cell.className = "cell";
      let val = board[r][c];
      if (val) {
        cell.textContent = val;
        cell.classList.add("n" + val);
      }
      boardDiv.appendChild(cell);
    }
  }
  document.getElementById("score").textContent = score;
}

function slide(row) {
  row = row.filter(val => val);
  for (let i = 0; i < row.length - 1; i++) {
    if (row[i] === row[i + 1]) {
      row[i] *= 2;
      score += row[i];
      row[i + 1] = 0;
    }
  }
  row = row.filter(val => val);
  while (row.length < SIZE) row.push(0);
  return row;
}

function moveLeft() {
  let changed = false;
  for (let r = 0; r < SIZE; r++) {
    let newRow = slide(board[r]);
    if (newRow.toString() !== board[r].toString()) changed = true;
    board[r] = newRow;
  }
  if (changed) { addRandomTile(); updateBoard(); }
}

function moveRight() {
  let changed = false;
  for (let r = 0; r < SIZE; r++) {
    let newRow = slide(board[r].reverse()).reverse();
    if (newRow.toString() !== board[r].toString()) changed = true;
    board[r] = newRow;
  }
  if (changed) { addRandomTile(); updateBoard(); }
}

function moveUp() {
  let changed = false;
  for (let c = 0; c < SIZE; c++) {
    let col = [];
    for (let r = 0; r < SIZE; r++) col.push(board[r][c]);
    let newCol = slide(col);
    for (let r = 0; r < SIZE; r++) {
      if (board[r][c] !== newCol[r]) changed = true;
      board[r][c] = newCol[r];
    }
  }
  if (changed) { addRandomTile(); updateBoard(); }
}

function moveDown() {
  let changed = false;
  for (let c = 0; c < SIZE; c++) {
    let col = [];
    for (let r = 0; r < SIZE; r++) col.push(board[r][c]);
    let newCol = slide(col.reverse()).reverse();
    for (let r = 0; r < SIZE; r++) {
      if (board[r][c] !== newCol[r]) changed = true;
      board[r][c] = newCol[r];
    }
  }
  if (changed) { addRandomTile(); updateBoard(); }
}

// Key controls
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") moveLeft();
  if (e.key === "ArrowRight") moveRight();
  if (e.key === "ArrowUp") moveUp();
  if (e.key === "ArrowDown") moveDown();
});

// Touch controls
let startX, startY;
document.addEventListener("touchstart", e => {
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
});
document.addEventListener("touchend", e => {
  let dx = e.changedTouches[0].clientX - startX;
  let dy = e.changedTouches[0].clientY - startY;
  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 30) moveRight();
    else if (dx < -30) moveLeft();
  } else {
    if (dy > 30) moveDown();
    else if (dy < -30) moveUp();
  }
});

startGame();
</script>
</body>
</html>
